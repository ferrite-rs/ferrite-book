<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Session Types - Writing Session-Typed Ferrite Programs in Rust</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../ferrite.html"><strong aria-hidden="true">1.</strong> Writing Session-Typed Ferrite Programs in Rust</a></li><li class="chapter-item expanded "><a href="../01-getting-started/00-getting-started.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../01-getting-started/01-installation.html"><strong aria-hidden="true">2.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../01-getting-started/02-hello-world.html"><strong aria-hidden="true">2.2.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="../01-getting-started/03-communication.html"><strong aria-hidden="true">2.3.</strong> Client Communication</a></li><li class="chapter-item expanded "><a href="../01-getting-started/04-type-errors.html"><strong aria-hidden="true">2.4.</strong> Type Errors</a></li><li class="chapter-item expanded "><a href="../01-getting-started/05-session-types.html" class="active"><strong aria-hidden="true">2.5.</strong> Session Types</a></li></ol></li><li class="chapter-item expanded "><a href="../02-main-concepts/00-main-concepts.html"><strong aria-hidden="true">3.</strong> Main Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../02-main-concepts/01-protocols.html"><strong aria-hidden="true">3.1.</strong> Protocols</a></li><li class="chapter-item expanded "><a href="../02-main-concepts/02-linear-context.html"><strong aria-hidden="true">3.2.</strong> Linear Context</a></li><li class="chapter-item expanded "><a href="../02-main-concepts/03-sessions.html"><strong aria-hidden="true">3.3.</strong> Sessions</a></li><li class="chapter-item expanded "><a href="../02-main-concepts/04-channel-selectors.html"><strong aria-hidden="true">3.4.</strong> Channel Selectors</a></li><li class="chapter-item expanded "><a href="../02-main-concepts/05-running-sessions.html"><strong aria-hidden="true">3.5.</strong> Running Sessions</a></li><li class="chapter-item expanded "><a href="../02-main-concepts/06-hole-driven-development.html"><strong aria-hidden="true">3.6.</strong> Hole Driven Development</a></li></ol></li><li class="chapter-item expanded "><a href="../03-basic-constructs/00-basic-constructs.html"><strong aria-hidden="true">4.</strong> Basic Constructs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../03-basic-constructs/01-termination.html"><strong aria-hidden="true">4.1.</strong> Termination</a></li><li class="chapter-item expanded "><a href="../03-basic-constructs/02-send-receive-values.html"><strong aria-hidden="true">4.2.</strong> Send / Receive Values</a></li><li class="chapter-item expanded "><a href="../03-basic-constructs/03-send-receive-channels.html"><strong aria-hidden="true">4.3.</strong> Send / Receive Channels</a></li><li class="chapter-item expanded "><a href="../03-basic-constructs/04-external-choice.html"><strong aria-hidden="true">4.4.</strong> External Choice</a></li><li class="chapter-item expanded "><a href="../03-basic-constructs/05-internal-choice.html"><strong aria-hidden="true">4.5.</strong> Internal Choice</a></li></ol></li><li class="chapter-item expanded "><a href="../04-advanced-constructs/00-advanced-constructs.html"><strong aria-hidden="true">5.</strong> Advanced Constructs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../04-advanced-constructs/01-recursive-session-types.html"><strong aria-hidden="true">5.1.</strong> Recursive Session Types</a></li><li class="chapter-item expanded "><a href="../04-advanced-constructs/02-communication.html"><strong aria-hidden="true">5.2.</strong> Communication</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Shared Session Types</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Example Usage</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> Communication Protocols</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> Shared Resources</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Ferrite Internals</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Higher Kinded Types</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> Cloaking Constraints</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.3.</strong> Optics</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.4.</strong> Row Polymorphism</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Conclusion</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> TODO</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Writing Session-Typed Ferrite Programs in Rust</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#session-types" id="session-types">Session Types</a></h1>
<p>This chapter provides some supplementary overview of session types,
the type theory that Ferrite is based on. In the discussion we
will talk about some concepts related to
<a href="https://en.wikipedia.org/wiki/Mathematical_logic">logic</a> and
<a href="https://en.wikipedia.org/wiki/Type_theory">type theory</a>.
For readers who are unfamiliar with these topics, feel free
to skip this chapter and move on to the
<a href="./06-macros.html">next chapter</a>.</p>
<h2><a class="header" href="#background-on-session-types" id="background-on-session-types">Background on Session Types</a></h2>
<p>So far we have been talking about session types without going into details
what it is. Broadly speaking, session types can refer to a branch of
type systems used to model structured communication-based
programming. Session types are also known as <em>behavioural types</em>, since
the types describe the behaviour of a program.</p>
<p>From the theoretical perspective, session types establish a
<a href="https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence">correspondence</a>
with <a href="https://plato.stanford.edu/entries/logic-linear/">linear logic</a>.
This makes session-typed languages slightly different from functional
languages such as Rust and Haskell, which have their roots in
<a href="https://plato.stanford.edu/entries/lambda-calculus/">lambda calculus</a>
and
<a href="https://plato.stanford.edu/entries/logic-intuitionistic/">intuitionistic logic</a>.</p>
<p>Throughout this book, we will learn about various concepts of session types
from the perspective of a Rust programmer. While this may not be a comprehensive
overview of session types themselves, we aim to cover enough of the basics
so that you can explore more deeply into session types through other resources.</p>
<h2><a class="header" href="#linear-affine-and-structural-rules" id="linear-affine-and-structural-rules">Linear, Affine, and Structural Rules</a></h2>
<p>One notable distiction between session types and Rust is that session typed
variables are <em>linear</em>, while Rust variables are <em>affine</em> by default.
We will try to understand what that really means.</p>
<p>A common explanation of linear vs affine is that linear variables must be
used exactly once, while affine variables can be used at most once.
However that is not entirely accurate.</p>
<p>To be more precise, type theorists differentiate different kinds of
type systems based on which
<a href="https://en.wikipedia.org/wiki/Structural_rule">structural rules</a>
are allowed in the type system:</p>
<ul>
<li>
<p>In a normal type system like Haskell, variables are allowed to be used
more than once (contraction). Variables are also allowed to be discarded
(weakening).</p>
</li>
<li>
<p>In an affine type system like Rust, variables are <em>not</em> allowed to be used
more than once (no contraction), unless they specifically implement
<code>Copy</code> or <code>Clone</code>.
However variables are still allowed to be discarded (weakening).</p>
</li>
<li>
<p>In a linear type system like Ferrite, variables are <em>not</em> allowed to be
used more than once (no contraction), and variables are <em>not</em> allowed to
be discarded (no weakening).</p>
</li>
</ul>
<p>As we have seen in the previous chapter, Ferrite programs like <code>hello_client</code>
interact with channel variables multiple times, with the session type of
the channel changing every time after interaction. Under linear typing rules,
we cannot make multiple copies of the channel, and we also cannot discard
the channel until it is explicitly terminated.</p>
<h2><a class="header" href="#intuitionistic-vs-classical-linear-logic" id="intuitionistic-vs-classical-linear-logic">Intuitionistic vs Classical Linear Logic</a></h2>
<p>Since session types cover a family of programming languages, readers with
some familiarity with session types may notice that Ferrite's implementation
is quite different from some other session types implementations in the wild,
such as <a href="https://github.com/Munksgaard/session-types">session-types</a>
and <a href="https://github.com/wenkokke/sesh">sesh</a>.</p>
<p>Ferrite's implementation of session types is based on
<em>intuitionistic</em> linear logic. This is in contrast with the <em>classical</em>
linear logic formulation that is used by some other session types
implementations.</p>
<p>From the programmers' perspective, there are some key differences when
using the intuitionistic formulation of session types in Ferrite.
For example, you may notice that there is no need for <em>dualization</em>
in Ferrite. This means that the session type signature remain the
same from the perspective of both the provider and the client.</p>
<p>As illustrated in the <a href="./03-communication.html">previous chapter</a>,
while the provider <code>hello_provider</code> sends a string value through
a channel with the session type <code>SendValue&lt;String, End&gt;</code>,
the client <code>hello_client</code> <em>receives</em> a value from a channel of the
same session type.</p>
<p>In comparison, with classical formulation, we would instead
have to explicitly dualize the session type. As a result,
the session type of the channel given to <code>hello_client</code> would
instead have the session type <code>ReceiveValue&lt;String, End&gt;</code>.</p>
<p>Both intuitionistic and classical formulation of session types
share the same foundation, viewed from different angles.
From the perspective of a type theorist, it may be more
convenient to formulate proofs with the help of dualization
in the classical formulation.</p>
<p>From the perspective of a programmer, it may be more intuitive to understand
session types in the intuitionistic formulation. Intuitionistic session types
have closer semantics with lambda calculus, and this makes it easier for
programmers to bridge the concepts with their existing knowledge in
functional programming.</p>
<p>We leave it to informed readers to decide whether the intuitionistic formulation
of Ferrite provides better intuition for programming in session types.
For the purpose of this book, it is only important for us to clarify
the distinctions, so that readers are better informed when comparing
Ferrite with other session types implementations.</p>
<h2><a class="header" href="#learn-more" id="learn-more">Learn More</a></h2>
<p>If you are interested to learn more about session types, there are
a wealth of type theoretic resources available. To get started,
we recommend the following learning materials by our co-author:</p>
<ul>
<li>
<p>Tutorial slides - <a href="http://www.cs.cmu.edu/%7Ebalzers/publications/session_typed_concurrent_programming.pdf">Session-Typed Concurrent Programming</a></p>
</li>
<li>
<p>OPLSS video lectures - <a href="https://www.youtube.com/watch?v=xYhGY0Lq8cw&amp;list=PL0DsGHMPLUWWyBBTpnTBKsYxdkbIoy1q8">Session-Typed Concurrent Programming</a></p>
</li>
</ul>
<p>Other than that, the research group <a href="http://groups.inf.ed.ac.uk/abcd/index.html">ABCD</a>
also publishes a comprehensive list of resources related to
session types, including a list of
<a href="http://groups.inf.ed.ac.uk/abcd/session-implementations.html">session types implementations</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../01-getting-started/04-type-errors.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../02-main-concepts/00-main-concepts.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../01-getting-started/04-type-errors.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../02-main-concepts/00-main-concepts.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
